Day 2: Multidimensional Grids and Data

1) Resources:

The lecture 3 of GPU Computing by Dr. Izzat El Hajj  
Lecture 3: https://youtu.be/c8dehGOB8mQ?si=Dsimjh8cSI8ETI-3  

2) Topics Covered:
- Creating multidimensional grids
- Storing and accesing multidimensional data
- The implementation of vector image RGB to grayscale conversion and image blurring using CUDA

3) Summary of the Lecture:  

- Assgining one thread to convert each pixel in the image (e.g., multidimensional array)
- Multidimensional grids simplifies the processing of multidimensional data
- Threadblock is in 2D
- Multidimensional data: to be stored in row major order:

<pre>
a b c d
e f g h --> a b c d e f g h i j k l
i j k l
</pre>

4) Implementation:

- RGB to grayscale conversion:  

The implementation of RGB to grayscale conversion is done with `rgb_to_gray.cu`. The code generates a random RGB image and converts it to grayscale by defining 2D grids and blocks and checking boundary conditions along rows and columns. The grayscale image is the weighted sum of the RGB channels. The weights are 3/10, 6/10, and 1/10 for red, green, and blue channels, respectively.

Compiling the code:  

<pre> nvcc rgb2gray.cu -o rgb2gray </pre>

Running the code after compiling: 
<pre> rgb2gray </pre>

The code was executed on the NVIDIA GeForce RTX 3080Ti Laptop GPU - 16 GB. The output of the code is as follows:

<pre>Time for memory allocation: 0.611328 ms
Time for host-to-device copy: 0.541248 ms
Time for kernel execution: 0.796000 ms
Time for device-to-host copy: 0.360128 ms
</pre>

- Image bluring:  

The implementation of image blurring is done with `blur.cu`. The code generates a random RGB image and blurs the original image by performing averaging output pixel's neighbor pixels. Assigning one thread to each output pixel and generated by multiple input pixels. Boundary condition is defined as input row and column should be greater than 0 and less than height and width, respectively. Afterwards, the output pixel is the average of the input pixels (2*blurkernelsize + 1).

Compiling the code:  

<pre> nvcc blur.cu -o blur </pre>

Running the code after compiling: 
<pre> blur </pre>

The code was executed on the NVIDIA GeForce RTX 3080Ti Laptop GPU - 16 GB. The output of the code is as follows:

<pre>Time for memory allocation: 0.576512 ms
Time for host-to-device copy: 0.201632 ms
Time for kernel execution: 0.783168 ms
Time for device-to-host copy: 0.363648 ms
</pre>